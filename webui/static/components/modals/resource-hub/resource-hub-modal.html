<html>
<head>
  <title>Resource Hub</title>
  <script type="module">
    import { store } from "/components/modals/resource-hub/resource-hub-store.js";
  </script>
</head>
<body>
  <div x-data>
    <template x-if="$store.resourceHubStore">
      <div class="resource-hub-root">
        <div class="resource-hub-sidebar">
          <button class="resource-nav-item" :class="{active: $store.resourceHubStore.activeSection === 'overview'}" @click="$store.resourceHubStore.openSection('overview')">Overview</button>
          <button class="resource-nav-item" :class="{active: $store.resourceHubStore.activeSection === 'adapters'}" @click="$store.resourceHubStore.openSection('adapters')">Adapters (<span x-text="$store.resourceHubStore.data.adapters.length"></span>)</button>
          <button class="resource-nav-item" :class="{active: $store.resourceHubStore.activeSection === 'prompts'}" @click="$store.resourceHubStore.openSection('prompts')">Prompts (<span x-text="$store.resourceHubStore.data.prompts.length"></span>)</button>
          <button class="resource-nav-item" :class="{active: $store.resourceHubStore.activeSection === 'tools'}" @click="$store.resourceHubStore.openSection('tools')">Tools (<span x-text="$store.resourceHubStore.data.tools.length"></span>)</button>
          <button class="resource-nav-item" :class="{active: $store.resourceHubStore.activeSection === 'skills'}" @click="$store.resourceHubStore.openSection('skills')">Skills (<span x-text="$store.resourceHubStore.data.skills.length"></span>)</button>
          <button class="resource-nav-item" :class="{active: $store.resourceHubStore.activeSection === 'tasks'}" @click="$store.resourceHubStore.openSection('tasks')">Tasks (<span x-text="$store.resourceHubStore.data.tasks.length"></span>)</button>
        </div>

        <div class="resource-hub-content">
          <div x-show="$store.resourceHubStore.isLoading" class="resource-loading">Loading resources...</div>

          <div x-show="!$store.resourceHubStore.isLoading && $store.resourceHubStore.activeSection === 'overview'" class="resource-overview">
            <div class="resource-summary-grid">
              <div class="resource-summary-card"><strong>Adapters</strong><span x-text="$store.resourceHubStore.data.adapters.length"></span></div>
              <div class="resource-summary-card"><strong>Prompts</strong><span x-text="$store.resourceHubStore.data.prompts.length"></span></div>
              <div class="resource-summary-card"><strong>Tools</strong><span x-text="$store.resourceHubStore.data.tools.length"></span></div>
              <div class="resource-summary-card"><strong>Skills</strong><span x-text="$store.resourceHubStore.data.skills.length"></span></div>
              <div class="resource-summary-card"><strong>Tasks</strong><span x-text="$store.resourceHubStore.data.tasks.length"></span></div>
              <div class="resource-summary-card"><strong>MCP Tools</strong><span x-text="$store.resourceHubStore.data.mcp.total_tools || 0"></span></div>
            </div>
            <div class="resource-actions">
              <button class="button" @click="$store.resourceHubStore.openSkillsSettings()">Open Skills Settings</button>
              <button class="button" @click="$store.resourceHubStore.openMcpSettings()">Open MCP Settings</button>
              <button class="button" @click="$store.resourceHubStore.openScheduler()">Open Scheduler</button>
            </div>
          </div>

          <div x-show="!$store.resourceHubStore.isLoading && $store.resourceHubStore.activeSection !== 'overview'" class="resource-list-layout">
            <div class="resource-list-panel">
              <template x-if="$store.resourceHubStore.activeSection === 'tasks'">
                <ul class="resource-list">
                  <template x-for="task in $store.resourceHubStore.data.tasks" :key="task.id">
                    <li class="resource-list-item">
                      <span x-text="task.title || task.id"></span>
                      <span class="resource-badge" x-text="task.status || 'unknown'"></span>
                    </li>
                  </template>
                </ul>
              </template>

              <template x-if="$store.resourceHubStore.activeSection !== 'tasks'">
                <ul class="resource-list">
                  <template x-for="item in $store.resourceHubStore.currentList" :key="item.name">
                    <li class="resource-list-item">
                      <button class="resource-item-btn" @click="$store.resourceHubStore.previewItem(item.name)">
                        <span x-text="item.name"></span>
                      </button>
                    </li>
                  </template>
                </ul>
              </template>
            </div>
            <div class="resource-preview-panel" x-show="$store.resourceHubStore.activeSection !== 'tasks'">
              <div class="resource-preview-title" x-text="$store.resourceHubStore.preview.name || 'Select an item to preview'"></div>
              <pre class="resource-preview-content" x-text="$store.resourceHubStore.preview.content || ''"></pre>
            </div>
          </div>
        </div>
      </div>
    </template>
  </div>

  <style>
    .resource-hub-root { display: flex; min-height: 62vh; }
    .resource-hub-sidebar { width: 220px; border-right: 1px solid var(--color-border); padding-right: 0.5rem; }
    .resource-nav-item { width: 100%; text-align: left; background: transparent; border: none; color: var(--color-text); padding: 0.55rem 0.6rem; border-radius: 6px; cursor: pointer; }
    .resource-nav-item:hover { background: var(--color-background-hover); }
    .resource-nav-item.active { background: var(--color-panel); border: 1px solid var(--color-border); }
    .resource-hub-content { flex: 1; padding: 0 0 0 1rem; }
    .resource-loading { opacity: 0.8; }
    .resource-summary-grid { display: grid; grid-template-columns: repeat(3, minmax(120px, 1fr)); gap: 0.75rem; }
    .resource-summary-card { border: 1px solid var(--color-border); border-radius: 8px; padding: 0.75rem; display: flex; justify-content: space-between; align-items: center; background: var(--color-panel); }
    .resource-actions { margin-top: 1rem; display: flex; gap: 0.5rem; }
    .resource-list-layout { display: flex; gap: 0.75rem; min-height: 52vh; }
    .resource-list-panel { width: 280px; border: 1px solid var(--color-border); border-radius: 8px; overflow: auto; }
    .resource-list { list-style: none; margin: 0; padding: 0; }
    .resource-list-item { display: flex; justify-content: space-between; align-items: center; padding: 0.45rem 0.6rem; border-bottom: 1px solid var(--color-border); }
    .resource-item-btn { all: unset; width: 100%; cursor: pointer; }
    .resource-item-btn:hover { opacity: 0.85; }
    .resource-preview-panel { flex: 1; border: 1px solid var(--color-border); border-radius: 8px; overflow: hidden; display: flex; flex-direction: column; }
    .resource-preview-title { padding: 0.55rem 0.75rem; border-bottom: 1px solid var(--color-border); font-weight: 600; }
    .resource-preview-content { margin: 0; padding: 0.75rem; white-space: pre-wrap; word-break: break-word; overflow: auto; flex: 1; }
    .resource-badge { font-size: 0.75rem; border: 1px solid var(--color-border); border-radius: 8px; padding: 0.1rem 0.5rem; }
  </style>
</body>
</html>
